<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ë°©ëª…ë¡</title>
<style>
body{font-family:'Noto Sans KR',sans-serif;background:#f4f6f9;padding:30px;display:flex;flex-direction:column;align-items:center;}
form,.messages{background:white;padding:20px;border-radius:12px;box-shadow:0 2px 10px rgba(0,0,0,0.1);width:100%;max-width:400px;margin-top:15px;}
input,textarea{width:100%;padding:10px;margin-bottom:10px;border:1px solid #ccc;border-radius:8px;}
button{background:#4CAF50;color:white;border:none;padding:10px;width:100%;border-radius:8px;cursor:pointer;}
.msg{background:#e9ffe9;border-radius:8px;padding:10px;margin:8px 0;}
</style>
</head>
<body>
<h2>ğŸ“– ë°©ëª…ë¡</h2>
<button onclick="logout()" style="background:#f44336;margin-bottom:10px;">ë¡œê·¸ì•„ì›ƒ</button>
<form onsubmit="saveMessage(event)">
  <textarea id="message" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." required></textarea>
  <button type="submit">ë“±ë¡</button>
</form>
<div class="messages" id="messages"></div>

<script>
  const user = JSON.parse(localStorage.getItem("loggedInUser"));
  if (!user) location.href = "index.html";

  function logout() {
    localStorage.removeItem("loggedInUser");
    location.href = "index.html";
  }

  const msgs = JSON.parse(localStorage.getItem("messages") || "[]");
  const messagesDiv = document.getElementById("messages");

  function renderMessages() {
    messagesDiv.innerHTML = "";
    msgs.forEach((m,i)=>{
      const div = document.createElement("div");
      div.className="msg";
      div.innerHTML = `<b>${m.user}</b> (${m.time})<br>${m.text}`;
      messagesDiv.appendChild(div);
    });
  }
  renderMessages();

  function saveMessage(e){
    e.preventDefault();
    const msg = message.value.trim();
    if(!msg)return;
    msgs.push({ user:user.id, text:msg, time:new Date().toLocaleString() });
    localStorage.setItem("messages",JSON.stringify(msgs));
    message.value="";
    renderMessages();
  }
</script>
</body>
</html>
